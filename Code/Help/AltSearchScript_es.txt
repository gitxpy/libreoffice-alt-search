; Archivo con lotes para Buscar y reemplazar Alternativo
; para la extension AltSearch.oxt para Writer
; Charset: UTF-8 
;
; Sintaxis:
; Las lineas que no comiencen por algun comando principal se ignorarán.
; El comando principal debe estar encerrado entre corchetes [] 
; y debe estar al principio de la linea. Puede haber espacios delante del
; comando principal, todo lo que vaya detrás se interpreta como parámetros.
; 
;  Descripción de comandos principales:
;  [Name] - nombre del lote (conocido como parametro) - un lote sencillo comienza
;  siempre con este comando principal. El final del lote se determina por 
;  el siguiente comando [Name] o [End] para último lote válido.
;  Un separador se hace con una sola linea [Name] sin comandos después.
;
;  [Find] - expresión de búsqueda - en la ejecución el parámetro se
;      transfiere al campo "Buscar"
;  [Replace] - expresión de reemplazo - en la ejecución el parámetro se 
;      transfiere al campo "Reemplazar"
;  [Parameters] - parámetros de búsqueda o reemplazo - una cadena vacía establece los
;      valores de todos los parámetros a falso, mencionar un parámetro
;      lo pondrá a verdadero.  
;     Parametros aceptados:  
;        MatchCase  PreserveCapital  WholeWord  ParaStyles  Regular
;        CurrSelection  Backwards  MsgOff  NoSummary  
;
;  [Command] - determina el modo de ejecutar la búsqueda y el reemplazo -
;    Comandos aceptados:  Find  FindAll  Replace  ReplaceAll  Count
;
;  En el futuro tambien podrá haber instrucciones para movimiento del cursor, 
;   establecer marcador según el cursor y restaurar el cursor
;   de acuerdo con el marcador etc.
;       
;  [End] - indica el final del último lote válido - todo lo que vaya detrás
;      será ignorado.  
;
;********************************************************************
  
[Name]   *************** Texto  ***************************** 

[Name] Texto [Sel.] Junta parrafos en uno solo
 ; bloque de párrafos vacios se reemplazan por un párrafo vacio 
  [Find]\p{2,}
  [Replace]\p\p
  [Parameters] MsgOff Regular CurrSelection 
  [Command] ReplaceAll

 ; quita espacios y tabuladores al principio y final de párrafos
  [Find](^( *\t*)*|( *\t*)*$)
  [Replace]
  [Command] ReplaceAll

 ; quita finales de párrafos
  [Find]\p
  [Replace]  
  [Command] ReplaceAll

 ; quita espacio al comienzo del párrafo tras un bloque de párrafos vacios
  [Find]^ 
  [Replace]
  [Command] ReplaceAll

 ; Sustituye dos espacios por uno solo
  [Find]  
  [Replace] 
  [Command] ReplaceAll
  


[Name] Texto [Sel.] Divide las frases en párrafos ¡¡¡ELimina 1º letra 1er parrafo!!
  [Find]^.[::BigBlock::]\.
  [Replace]\f&\e\p
; ******   El modificador \f indica portapapeles, sin el no se obtiene el texto del bloque de texto. ******
  [Parameters]   MsgOff  Regular  CurrSelection  
  [Command] ReplaceAll

[Name] Texto [Sel.] Añade un parrafo vacío de Separación entre  parrafos
  [Find]^.+$
  [Replace]&\p
  [Parameters]  MsgOff Regular CurrSelection
  [Command] ReplaceAll


[Name]  **************** Objetos ****************************** 
[Name] Hyperenlaces [Todos] Copia Los Hiperenlaces en un archivo nuevo
  [Find][:::HyperLinkURL::]
  [Replace]\P{Text body}Enlace \i, en página \I: \D\C{Emphasis}\h&\h{\u}\C{}\n(URL:  \C{Emphasis}\u\C{})\h\p \R
  [Parameters]  MsgOff Regular  
  [Command] ReplaceAll


[Name] Comentarios [Todos] Copia los comentarios en un archivo nuevo
  [Find][::Comment::]
  [Replace]\P{Text body}Comentario \i, en página \I, Contenido:\C{Emphasis}\n\o\C{Strong Emphasis}\p\R
  [Parameters]  MsgOff Regular  
  [Command] ReplaceAll

[Name] Imágenes [Todas] Copia las Imagenes en un archivo nuevo
  [Find][::Picture::]
  [Replace]\P{Text body}Imagen \i, en página \I\n- Nombre de imagen: \C{Emphasis}\O\C{Strong Emphasis}\n- Texto alt: \C{Emphasis}\o\C{Strong Emphasis}\p & \p\R
  [Parameters]  MsgOff Regular Backwards
  [Command] ReplaceAll


[Name] Tablas [Todas] Copia las Tablas en un archivo nuevo
  [Find][::TextTable::]
  [Replace]\P{Text body}Tabla \i, en página \I, Nombre de tabla: \C{Emphasis}\O\C{Strong Emphasis}\p&\p\p\R
  [Parameters]  MsgOff Regular
  [Command] ReplaceAll


[Name] Marcos [Todos] Copia los Marcos de texto en un archivo nuevo
  [Find][::TextFrame::]
  [Replace]\P{Text body}Marco \i, en página \I, Nombre del Marco:\C{Emphasis} \O\C{Strong Emphasis}\p&\C{}\p\R
  [Parameters]  MsgOff Regular
  [Command] ReplaceAll
  
[Name]  **************** Otros  ****************************** 

[Name] Html [Sel.] Convierte etiquetas antiguas a las nuevas Html
; los mismos parámetros para todo
  [Parameters] MsgOff Regular CurrSelection

; negrita
  [Find][:::CharWeight::]
  [Replace]<b>&</b>
  [Command] ReplaceAll 

; itálica
  [Find][:::CharPosture::]
  [Replace]<i>&</i>
  [Command] ReplaceAll         	

; Hyperenlaces 
  [Find][:::HyperLinkURL::]
  [Replace]<a href="\u">&</a>
  [Command] ReplaceAll

; Notas al pie
  [Find][::Footnote::]
  [Replace]<b><span Title="\o">…<span style="vertical-align: super; font-size: smaller;">\i</span></span></b>
  [Command] ReplaceAll

; agregar etiquetas a los párrafos 
  [Find]^.*$
  [Replace]<p>&</p>
  [Command] ReplaceAll

; Eliminar principios y finales redundantes de etiquetas identicas en secuencia
  [Find]</i><i>|</b><b>|</p><p>
  [Replace]
  [Command] ReplaceAll
 

[Name] BBCode [Sel.] Convierte texto seleccionado en código BBcode
  ; (Lenguaje de etiquetas de muchos foros)
  ; Los mismos parámetros para todas las ordenes 
  [Parameters] MsgOff Regular CurrSelection

  [Find][:::CharWeight::]
  [Replace][b]&[/b]
  [Command] ReplaceAll

  [Find][:::CharPosture::]
  [Replace][i]&[/i]
  [Command] ReplaceAll

  [Find][:::CharUnderline::]
  [Replace][u]&[/u]
  [Command] ReplaceAll

  [Find][:::CharAutoEscapement=true|CharEscapementHeight=58|CharEscapement=-101::]
  [Replace][sub]&[/sub]\d
  [Command] ReplaceAll

  [Find][:::CharAutoEscapement=true|CharEscapementHeight=58|CharEscapement=101::]
  [Replace][sup]&[/sup]\d
  [Command] ReplaceAll

  [Find][:::HyperLinkURL::]
  [Replace][url=\u]&[/url]
  [Command] ReplaceAll

  [Find][::Picture::]
  [Replace][img]\O[/img]
  [Command] ReplaceAll

  [Find][:::CharFontName=Courier New::]
  [Replace][code]&[/code]
  [Command] ReplaceAll

  ; Remove redundant ends-starts of identical tags in sequence
  [Find]\[/b]\[b]|\[/i]\[i]|\[/u]\[u]|\[/sub]\[sub]|\[/sup]\[sup]|\[/code]\[code]
  [Replace]
  [Command] ReplaceAll
  
  ; code through paragraph  
  [Find]\[/code]\p\[code]
  [Replace]\p
  [Command] ReplaceAll

  ; code through line break  
  [Find]\[/code]\n\[code]
  [Replace]\n
  [Command] ReplaceAll

  ; lists items
  [Find][:::NumberingStyleName=::]
  [Replace][list][*]&[/list]
  [Command] ReplaceAll

  ; Remove redundant list tags 
  [Find]\[/list]\p\[list]
  [Replace]\p
  [Command] ReplaceAll


[Name]  **************** Fechas ******************************* 


[Name] Fecha [Todas] De YYYY-MM-DD a DD.MM.YYYY
  [Find](\d{1,4})-(\d{1,2})-(\d{1,4})
  [Replace]\3.\2.\1
  [Parameters]   MsgOff  Regular  
  [Command] ReplaceAll


[Name] Fecha [Todas] De DD.MM.YYYY a YYYY-MM-DD
  [Find](\d{1,2})\. *(\d{1,2})\. *(\d{1,4})
  [Replace]\3-\2-\1
  [Parameters]   MsgOff  Regular  
  [Command] ReplaceAll


[Name] Fecha [Todas] De YYYY-MM-DD a DD.MM.YY
  [Find](\d{2,2})(\d{2,2})-(\d{1,2})-(\d{1,2})
  [Replace]\4.\3.\2
  [Parameters]   MsgOff  Regular  
  [Command] ReplaceAll

[End]
