; File with batchs for alternative Find & Replace
; for extension AltSearch.oxt for Writer
; Charset: UTF-8 
;
;  1.5.2 last modified 2025-08-29
;
; Syntax:
; Lines which do not begin with some master command will be ignored.
; Master command must be bounded in [] and must be at the beginning of the line.
;  There can be spaces in front of the master command, everything behind it will be
;  interpreted as parameters.
; 
;  Description of master commands:
;  [Name] - batch name (referred to as parameter) - single batch always begins with this master command.
;           The end of batch is determinated by next occurrence of command [Name] or [End] for the last valid batch.
;
;  [Find] - searched expression - at the execution of batch parameter it will be transferred to the field "Search for"
;
;  [Replace] - replaced expression - at the execution of batch parameter it will be transferred to the field "Replace"
;
;  [Parameters] - parameters of searching and replacing
;               - empty string matches settings of all parameters to ‘false’
;               - any string following parameter’s name will set it to ‘true’.
;      Accepted parameters:
;      --------------------
;          MatchCase  PreserveCapital  WholeWord  ParaStyles  Regular
;          CurrSelection  Backwards  MsgOff  NoSummary
;
;      MsgOff - suppress most error messages and information (for one step of search)
;      NoSummary - suppress the final report of whole batch (usefull if using key shortcut)  
;
;  [Command] - determine the mode of executing searching and replacing
;      Accepted parameters:
;      --------------------
;          Find  FindAll  Replace  ReplaceAll  Count
;
;      In the future there could be also instructions for the cursor’s movement,
;      setting of bookmarks according to cursor, restoration of the cursor
;      in accordance to bookmark etc…
;       
;  [End] - indicates the end of last valid batch - everything which is after that, will be ignored.  
************************************************************

[Name] HTML [Sel.] Primitive conversion to HTML tags for selected block    	 
  ; the same parameters for all 
  [Parameters] MsgOff Regular CurrSelection

  ; Bold
  [Find][:::CharWeight::]
  [Replace]<b>&</b>
  [Command] ReplaceAll

  ; Italic
  [Find][:::CharPosture::]
  [Replace]<i>&</i>
  [Command] ReplaceAll

  ; Hyperlinks
  [Find][:::HyperLinkURL::]
  [Replace]<a href="\u">&</a>
  [Command] ReplaceAll

  ; Footnotes
  [Find][::Footnote::]
  [Replace]<b><span Title="\o"><span style="vertical-align: super; font-size: smaller;">\i</span></span></b>
  [Command] ReplaceAll

  ; Add tags of paragraphs 
  [Find]^.*$
  [Replace]<p>&</p>
  [Command] ReplaceAll

  ; Underline
  [Find][:::CharUnderline::]
  [Replace][u]&[/u]
  [Command] ReplaceAll

  ; Underscript
  [Find][:::CharAutoEscapement=true|CharEscapementHeight=58|CharEscapement=-101::]
  [Replace][sub]&[/sub]\d
  [Command] ReplaceAll

  ; Superscript
  [Find][:::CharAutoEscapement=true|CharEscapementHeight=58|CharEscapement=101::]
  [Replace][sup]&[/sup]\d
  [Command] ReplaceAll

  ; Hyperlink
  [Find][:::HyperLinkURL::]
  [Replace][url=\u]&[/url]
  [Command] ReplaceAll

  ; Picture
  [Find][::Picture::]
  [Replace][img]\O[/img]
  [Command] ReplaceAll

  ; Courier font replacement
  [Find][:::CharFontName=Courier New::]
  [Replace][code]&[/code]
  [Command] ReplaceAll

  ; Remove redundant ends-starts of identical tags in sequence
  [Find]\[/b]\[b]|\[/i]\[i]|\[/u]\[u]|\[/sub]\[sub]|\[/sup]\[sup]|\[/code]\[code]
  [Replace]
  [Command] ReplaceAll
 
  ; Code through paragraph
  [Find]\[/code]\p\[code]
  [Replace]\p
  [Command] ReplaceAll

  ; Code through line break
  [Find]\[/code]\n\[code]
  [Replace]\n
  [Command] ReplaceAll

  ; Items of a list
  [Find][:::NumberingStyleName=::]
  [Replace][list][*]&[/list]
  [Command] ReplaceAll

  ; Remove redundant list tags
  [Find]\[/list]\p\[list]
  [Replace]\p
  [Command] ReplaceAll


[Name] Text [Sel.] Join paragraphs non separated by empty paragraphs
  ; block of empty paragraphs replace by one empty paragraph
  [Find]\p{2,}
  [Replace]\p\p
  [Parameters] MsgOff Regular CurrSelection 
  [Command] ReplaceAll

  ; remove spaces and tabs at the begin and at the end of paragraphs
  [Find](^( *\t*)*|( *\t*)*$)
  [Replace]
  [Command] ReplaceAll

  ; remove ends of paragraphs
  [Find]\p
  [Replace]  
  [Command] ReplaceAll

  ; remove space at the beginning of a paragraph behind of a block of empty paragraphs
  [Find]^ 
  [Replace]
  [Command] ReplaceAll


[Name] Text [Sel.] Separate non empty paragraphs by empty paragraph
  [Find]^.+$
  [Replace]&\p
  [Parameters]  MsgOff Regular CurrSelection
  [Command] ReplaceAll

; separator
[Name] 

[Name] Text [All] Conversion of the date from YYYY-MM-DD to DD.MM.YY
  [Find](\d{2,2})(\d{2,2})-(\d{1,2})-(\d{1,2})
  [Replace]\4.\3.\2
  [Parameters] MsgOff Regular  
  [Command] ReplaceAll

[Name] Text [All] Conversion of the date from DD.MM.YYYY to YY-MM-DD
  [Find](\d{1,2})\. *(\d{1,2})\. *(\d{2,2})(\d{2,2})
  [Replace]\4-\2-\1
  [Parameters] MsgOff Regular  
  [Command] ReplaceAll

[Name] Text [All] Conversion of the date from DD.MM.YYYY to YYYY-MM-DD
  [Find](\d{1,2})\. *(\d{1,2})\. *(\d{1,4})
  [Replace]\3-\2-\1
  [Parameters] MsgOff Regular  
  [Command] ReplaceAll


[Name] Text [All] Write out all Hyperlinks to a new file
  [Find][:::HyperLinkURL::]
  [Replace]\P{Text body}Link \i, on page \I: \D\C{Example}\h&\h{\u}\C (URL: \C{Example}\u\C)\C{Example}\p\h \R
  [Parameters] MsgOff Regular  
  [Command] ReplaceAll


[Name] Text [All] Write out all Comments in a new file
  [Find][::Comment::]
  [Replace]\P{Text body}Comment \i, on page \I, Content:\C{Emphasis}\n\o\C{Strong Emphasis}\p\R
  [Parameters] MsgOff Regular  
  [Command] ReplaceAll


[Name] Text [All]  Write out all Pictures to new file
  [Find][::Picture::]
  [Replace]\P{Text body}Immagine \i, on page \I\n- Name of the picture: \C{Emphasis}\O\C{Strong Emphasis}\n- Alt Text: \C{Emphasis}\o\C{Strong Emphasis}\p & \p\R
  [Parameters] MsgOff Regular Backwards
  [Command] ReplaceAll


[Name] Text [All] Write out all Tables to new file
  [Find][::TextTable::]
  [Replace]\P{Text body}Table \i, on page \I, Name of the table: \C{Emphasis}\O\C{Strong Emphasis}\p&\p\p\R
  [Parameters] MsgOff Regular
  [Command] ReplaceAll


[Name] Text [All] Write out all Text Frames to new file
  [Find][::TextFrame::]
  [Replace]\P{Text body}Frame \i, on page \I, Name of the Text Frame:\C{Emphasis} \O\C{Strong Emphasis}\p&\C{}\p\R
  [Parameters] MsgOff Regular
  [Command] ReplaceAll


[Name] Text [All] Replace the string "dialog window" with the same string matching Upper and Lower case letters, singular and plurals)
  ; Parametri comuni a tutti quattro i comandi:
  [Parametri] MsgOff MatchCase

  ; Uppercase
  [Find] dialog window
  [Replace] Dialog window
  [Command] ReplaceAll

  ; Lowercase
  [Find] Dialog window
  [Replace] dialog window
  [Command] ReplaceAll

  ; Uppercase plural
  [Find] Dialog window
  [Replace] Dialog windows
  [Command] ReplaceAll

  ; Lowercase plural
  [Find] Dialog window
  [Replace] dialog windows
  [Command] ReplaceAll

; ***** END OF THE ORIGINAL AltSearchScript_it.txt v.1.4.2 *****

[Name] Text [All] Substitution of “ ” with « » quotation marks
  [Parametri] MsgOff

  [Find]“
  [Replace]«
  [Command] ReplaceAll

  [Find]”
  [Replace]»
  [Command] ReplaceAll


[Name] Text [All] Substitution of 2 spaces with only one
  [Find]  
  [Replace] 
  [Command] ReplaceAll


[Name] Text [All] Remove comma before conjunctions "or" & "and"
  [Parametri] MsgOff Normale

  [Find], and
  [Replace] and \C{no character style}
  [Command] ReplaceAll

  [Find], or
  [Replace] or \C{no character style}
  [Command] ReplaceAll


[Name] Text [All] Substitution of the standard space (following the string "figure") with a non-breaking space, ie bound to the following string.
  [Parameters] MsgOff MatchCase

  [Find](figure 
  [Replace](figure 
  [Command] ReplaceAll

  [Find] figure 
  [Replace] figure 
  [Command] ReplaceAll


[Name] Text [All] Substitution of the standard space (following the string "Chapter") with a non-breaking space, ie bound to the following string.
  [Parameters] MsgOff MatchCase Regular

  [Find]Chapter 
  [Replace]Chapter 
  [Command] ReplaceAll

[Name] Mac keys[All] Remove the key sequence ⌘ e ⌥ (Mac-specific)
  [Parametri] MsgOff Regular

  [Find]⌘
  [Replace]\C{No character style}
  [Command] ReplaceAll

  [Find]⌥
  [Replace]\C{No character style}
  [Command] ReplaceAll


; *** SUB IUDICE ***
;[Name] Text [Sel.] ??? Separate sentences in the block of paragraphs removing the first letter of the paragraph!
;  [Find]^.[::BigBlock::]\.
;  [Replace]\f&\e\p
; ****** Regulare expression  \f refers to clipboard, otherwise it is not possible to get the text block ??? *****
;  [Parameters] MsgOff  Regular CurrSelection
;  [Command] ReplaceAll

[End]
